webpackJsonp([42],{OLJ5:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("6Trz"),i=l("zVef"),n={data:function(){var e=this,t=function(t,l,a){""===l?a(new Error("请再次输入密码")):l!==e.ruleForm.pass?a(new Error("两次输入密码不一致!")):a()};return{hint:{title:"操作提示",content:"网站系统管理员, 由总平台设置管理.点击列表里的删除按钮删除单个管理员时不受复选框的影响！复选框数据只在点击列表下方批量删除时有效。锁定管理员之后将不能登录。"},tableData:[],search:"",add_show:!1,crumb:{from:"管理员",now:"添加管理员"},ruleForm:{name:"",email:"",pass:"",ckPass:"",role_id:null},role_list:[],multipleSelection:[],rules:{name:[{validator:this.va.vaName,trigger:"blur"}],email:[{validator:this.va.vaEmail,trigger:"blur"}],pass:[{validator:this.va.vaPass,trigger:"blur"}],ckPass:[{validator:t,trigger:"blur"}],role_id:[{required:!0,message:"请选择所属角色"},{type:"number"}]},admin_name_disabled:!1,id:"",del_id:[],loading:!0}},created:function(){this.get_admins()},methods:{go_back:function(){this.add_show=!1,this.admin_name_disabled=!1},get_admins:function(){var e=this;this.axios.post(this.getApi("seller/auth/admins")).then(function(t){e.loading=!1,0===t.data.code?e.tableData=t.data.admins||[]:e.$message(t.data.msg)}).catch(function(){e.loading=!1,e.$message("对不起！请稍后再试")})},edit_admin:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t&&(this.admin_name_disabled=!0),this.id=t,this.add_show=!0,this.antiShake.antiShake(function(l,a){e.axios.post(e.getApi("seller/auth/admin-edit"),"id="+t).then(function(t){l(t),0===t.data.code&&(e.role_list=t.data.role_list,e.ruleForm=t.data)}).catch(function(e){a(e)})})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.antiShake.antiShake(function(e,l){t.axios.post(t.getApi("seller/auth/admins-save"),t.dafa({id:t.id,name:t.ruleForm.name,old_pass:t.ruleForm.old_pass,new_pass:t.ruleForm.pass,is_lock:t.ruleForm.is_lock,role_id:t.ruleForm.role_id})).then(function(l){e(l),0===l.data.code&&(t.add_show=!1,t.get_admins(),t.id="")}).catch(function(e){l(e)})})})},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e},del_admin:function(e){var t=this;this.$confirm("是否确认删除管理员?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){"all"===e?t.multipleSelection.forEach(function(e){t.del_id.push(e.id)}):t.del_id.push(e),t.axios.post(t.getApi("seller/auth/admins-del"),t.dafa({id:t.del_id})).then(function(e){t.$message(e.data.msg),t.del_id=[],0===e.data.code?t.get_admins():t.toggleSelection()}).catch(function(){t.$message("对不起！请稍后再试"),t.toggleSelection(),t.del_id=[]})}).catch(function(){t.toggleSelection(),t.del_id=[],t.$message({type:"info",message:"已取消删除"})})}},components:{hint:a.a,crumb:i.a}},o=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"admin prop-box"},[l("div",{staticClass:"m-admin m-prop-box"},[l("hint",{attrs:{title:e.hint.title,content:e.hint.content}}),e._v(" "),l("h2",[e._v("资源权限列表"),l("span",[e._v("（共"+e._s(e.tableData.length)+"条记录）")]),e._v(" "),l("el-button",{staticClass:"add-admin-btn add-btn",attrs:{type:"text",icon:"plus",size:"small"},on:{click:function(t){e.edit_admin("")}}},[e._v("添加管理员\n      ")])],1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{"element-loading-text":"拼命加载中",data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),l("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"用户名","min-width":"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"role_name",label:"角色名称","min-width":"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"last_ip",label:"最近登录IP","min-width":"130"}}),e._v(" "),l("el-table-column",{attrs:{prop:"last_login",label:"最近登录时间","min-width":"140"}}),e._v(" "),l("el-table-column",{attrs:{prop:"is_lock",label:"是否锁定","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.is_lock?l("span",[e._v("正常")]):l("span",[e._v("锁定")])]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"operation",label:"操作","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"primary",size:"small",icon:"edit"},on:{click:function(l){e.edit_admin(t.row.id)}}},[e._v("编辑\n          ")]),e._v(" "),l("el-button",{attrs:{type:"danger",size:"small",icon:"delete"},on:{click:function(l){e.del_admin(t.row.id)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),e.tableData.length>0?l("div",{staticClass:"select-all"},[l("el-button",{attrs:{plain:!0,type:"primary"},on:{click:function(t){e.toggleSelection()}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{plain:!0,disabled:0==e.multipleSelection.length,type:"danger"},on:{click:function(t){e.del_admin("all")}}},[e._v("\n        删除\n      ")])],1):e._e()],1),e._v(" "),e.add_show?l("div",{staticClass:"add-admin prop"},[l("crumb",{attrs:{from:e.crumb.from,now:e.crumb.now},on:{goBack:e.go_back}}),e._v(" "),l("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"lalabel-position":"right","label-width":"240px"}},[l("el-form-item",{attrs:{label:"管理员名称",prop:"name"}},[l("el-input",{attrs:{disabled:e.admin_name_disabled,placeholder:"请填写管理员名称"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"账号级别",prop:"pass"}},[1==e.ruleForm.super?[e._v("店主")]:[e._v("店铺管理")]],2),e._v(" "),e.admin_name_disabled?l("el-form-item",{attrs:{label:"原密码",prop:"pass"}},[l("el-input",{attrs:{type:"password",placeholder:"请填写登录密码"},model:{value:e.ruleForm.old_pass,callback:function(t){e.$set(e.ruleForm,"old_pass",t)},expression:"ruleForm.old_pass"}}),e._v(" "),l("em",{staticClass:"c-danger"})],1):e._e(),e._v(" "),l("el-form-item",{attrs:{label:"新密码",prop:"pass"}},[l("el-input",{attrs:{type:"password",placeholder:"请填写登录密码"},model:{value:e.ruleForm.pass,callback:function(t){e.$set(e.ruleForm,"pass",t)},expression:"ruleForm.pass"}}),e._v(" "),l("em",{staticClass:"c-danger"})],1),e._v(" "),l("el-form-item",{attrs:{label:"确认新密码",prop:"ckPass"}},[l("el-input",{attrs:{type:"password",placeholder:"请确认登录密码"},model:{value:e.ruleForm.ckPass,callback:function(t){e.$set(e.ruleForm,"ckPass",t)},expression:"ruleForm.ckPass"}})],1),e._v(" "),0==e.ruleForm.super?[l("el-form-item",{attrs:{label:"账号状态",prop:"is_lock"}},[l("el-select",{attrs:{placeholder:"请选择所属角色"},model:{value:e.ruleForm.is_lock,callback:function(t){e.$set(e.ruleForm,"is_lock",t)},expression:"ruleForm.is_lock"}},[l("el-option",{attrs:{label:"正常",value:0}}),e._v(" "),l("el-option",{attrs:{label:"锁定",value:1}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"所属角色",prop:"role"}},[l("el-select",{attrs:{placeholder:"请选择所属角色"},model:{value:e.ruleForm.role_id,callback:function(t){e.$set(e.ruleForm,"role_id",t)},expression:"ruleForm.role_id"}},e._l(e.role_list,function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)]:e._e(),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("确认保存")])],1)],2)],1):e._e()])},s=[],r={render:o,staticRenderFns:s},d=r,c=l("VU/8"),m=c(n,d,!1,null,null,null);t.default=m.exports}});