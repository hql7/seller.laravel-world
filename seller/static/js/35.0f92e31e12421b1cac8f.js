webpackJsonp([35],{Dwy2:function(t,e,a){var n=a("pw1D");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("e6df9cc4",n,!0)},UORH:function(t,e,a){"use strict";function n(t){a("Dwy2")}Object.defineProperty(e,"__esModule",{value:!0});var i=a("6Trz"),o=a("zVef"),s=a("js5j"),l={data:function(){return{hint:{title:"操作提示",content:"商品类型是用来规定某一类商品共有规格和属性的集合，商品的属性为商品说明参数，仅供展示。商品的规格为商品购买时必须选择的参数"},tableData:[],multipleSelection:[],totalPage:1,search:"",add_show:!1,crumb:{from:"商品类型",now:"类型编辑"},ruleForm:{id:"",name:"",attr:[{value:""}]},attr_tableData:[],attr_index:"",dynamicValidateForm:{domains:[{name:""}]},specs:[],spec_value:[],spec_tableData:[],radio:null,brands:[],brand_checkList:[],dialogVisible:!1,spec_dialogVisible:!1,rules:{name:[{required:!0,message:"请输入类型名称",trigger:"blur"}]},id:"",del_id:[],loading:!0}},created:function(){this.get_type()},methods:{go_back:function(){this.add_show=!1},to_page:function(){this.get_type()},get_type:function(){var t=this;this.axios.post(this.getApi("seller/auth/gt_list"),this.dafa({search_str:this.search,index:this.index})).then(function(e){t.loading=!1,0===e.data.code?(t.tableData=e.data.gt_list,t.totalPage=e.data.fy_pgCount):t.$message(e.data.msg)}).catch(function(){t.loading=!1,t.$message("对不起！请稍后再试")})},edit_type:function(t){var e=this;this.add_show=!0,this.id=t,this.antiShake.antiShake(function(t,a){e.axios.post(e.getApi("seller/auth/gt_edit"),"id="+e.id).then(function(a){t(a),0===a.data.code&&(a.data.info?(e.attr_tableData=a.data.info.attr,e.ruleForm.name=a.data.info.name,e.spec_tableData=a.data.info.spec,a.data.info.brand.forEach(function(t){e.brand_checkList.push(t.id)})):(e.ruleForm={id:"",name:""},e.attr_tableData=[],e.spec_tableData=[],e.brand_checkList=[]))}).catch(function(t){a(t),console.log(t)})}),this.getBrandList()},getBrandList:function(){var t=this;this.axios.post(this.getApi("seller/auth/brands_list"),"get_type=2").then(function(e){0===e.data.code?t.brands=e.data.brands:t.$message(e.data.msg)}).catch(function(t){console.log(t)})},add_attr:function(){this.attr_tableData.push({name:"",values:[],key:Date.now()})},del_attr:function(t,e){var a=this,n=[];t?this.axios.post(this.getApi("seller/auth/gt_attr_del"),"id="+t).then(function(e){a.$message(e.data.msg),0===e.data.code&&(a.attr_tableData.forEach(function(e){e.id!=t&&n.push(e)}),a.attr_tableData=n)}).catch(function(t){a.$message("对不起！请稍后再试")}):(this.attr_tableData.forEach(function(t){t.key!=e&&n.push(t)}),this.attr_tableData=n)},edit_attr:function(t){this.dialogVisible=!0,this.attr_index=t,this.dynamicValidateForm.domains=this.attr_tableData[t].values},addDomain:function(){this.dynamicValidateForm.domains.push({sort:"",key:Date.now()})},removeDomain:function(t){var e=this;if(t.id)this.antiShake.antiShake(function(a,n){e.axios.post(e.getApi("seller/auth/gt_value_del"),"id="+t.id).then(function(n){if(a(n),0===n.data.code){var i=e.dynamicValidateForm.domains.indexOf(t);-1!==i&&e.dynamicValidateForm.domains.splice(i,1)}}).catch(function(t){n(t)})});else{var a=this.dynamicValidateForm.domains.indexOf(t);-1!==a&&this.dynamicValidateForm.domains.splice(a,1)}},generate_attr_value:function(){this.dialogVisible=!1,this.attr_tableData[this.attr_index].values=this.dynamicValidateForm.domains},add_spec:function(){var t=this;this.spec_dialogVisible=!0,this.axios.post(this.getApi("seller/auth/specs_list"),"get_type=1").then(function(e){0===e.data.code?t.specs=e.data.specs:t.$message(e.data.msg)}).catch(function(e){t.$message("对不起！请稍后再试")})},spec_choice:function(t){var e=this;this.specs.forEach(function(a){a.id===t&&(e.spec_value=a.value)})},generate_add_spec:function(){var t=this,e=0;this.spec_tableData.forEach(function(a){a.id==t.radio&&(t.$message("此规格已存在"),e++)}),0==e&&(this.spec_dialogVisible=!1,this.specs.forEach(function(e){e.id==t.radio&&t.spec_tableData.push(e)}))},del_spec:function(t,e){e.splice(t,1)},toggleSelection:function(t){var e=this;t?t.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){this.multipleSelection=t},del_type:function(t){var e=this;this.$confirm("是否确认删除此类型?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){"all"===t?e.multipleSelection.forEach(function(t){e.del_id.push(t.id)}):e.del_id.push(t),e.axios.post(e.getApi("seller/auth/gt_del"),e.dafa({id_list:e.del_id})).then(function(t){e.$message(t.data.msg),e.del_id=[],0===t.data.code?e.get_type():e.toggleSelection()}).catch(function(t){console.log(t),e.$message("对不起！请稍后再试"),e.toggleSelection(),e.del_id=[]})}).catch(function(){e.toggleSelection(),e.del_id=[],e.$message({type:"info",message:"已取消删除"})})},submitForm:function(t){var e=this,a=[];this.spec_tableData.forEach(function(t){a.push(t.id)}),this.$refs[t].validate(function(t){if(!t)return e.$message("请检查填写信息是否有误"),!1;e.antiShake.antiShake(function(t,n){e.axios.post(e.getApi("seller/auth/gt_save"),e.dafa({id:e.id,name:e.ruleForm.name,attr:e.attr_tableData,spec_id:a,brand:e.brand_checkList})).then(function(a){t(a),0===a.data.code&&(e.add_show=!1,e.brand_checkList=[],e.get_type())}).catch(function(t){n(t),console.log(t)})})})}},computed:{index:function(){return this.$store.state.index}},components:{hint:i.a,crumb:o.a,page:s.a}},c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"type-list prop-box"},[a("div",{staticClass:"m-type-list m-prop-box"},[a("hint",{attrs:{title:t.hint.title,content:t.hint.content}}),t._v(" "),a("h2",[t._v("商品类型\n      "),t._v(" "),a("div",{staticClass:"u-right"},[a("el-input",{staticClass:"search",attrs:{placeholder:"搜索类型名称","prefix-icon":"el-icon-search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.get_type},slot:"append"})],1)],1)]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",attrs:{"element-loading-text":"拼命加载中",data:t.tableData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"small",icon:"edit"},on:{click:function(a){t.edit_type(e.row.id)}}},[t._v("编辑\n          ")])]}}])})],1),t._v(" "),a("page",{attrs:{totalPage:t.totalPage,currentPage:t.index},on:{toPage:t.to_page}})],1),t._v(" "),t.add_show?a("div",{staticClass:"add-type prop"},[a("crumb",{attrs:{from:t.crumb.from,now:t.crumb.now},on:{goBack:t.go_back}}),t._v(" "),a("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"240px"}},[a("el-form-item",{attrs:{label:"类型名称",prop:"name"}},[a("el-input",{attrs:{disabled:""},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"属性"}},[a("table",{staticClass:"attr-table"},[a("tr",[a("th",{staticClass:"ipt-th"},[t._v("属性名称")]),t._v(" "),a("th",[t._v("属性值")]),t._v(" "),a("th",{staticClass:"btn-th"},[t._v("操作")])]),t._v(" "),t._l(t.attr_tableData,function(e,n){return a("tr",[a("td",{staticClass:"sele-s"},[a("el-input",{attrs:{placeholder:"请输入属性名"},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"item.name"}})],1),t._v(" "),a("td",t._l(e.values,function(e){return a("span",[t._v(t._s(e.name)+" ,")])})),t._v(" "),a("td",[a("el-button",{attrs:{type:"primary",size:"small",icon:"edit"},on:{click:function(e){t.edit_attr(n)}}},[t._v("编辑\n              ")])],1)])})],2),t._v(" "),a("el-button",{on:{click:t.add_attr}},[t._v("新增属性")])],1),t._v(" "),a("el-form-item",{attrs:{label:"规格"}},[a("el-table",{attrs:{data:t.spec_tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"规格名称","min-width":"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"note",label:"规格备注","min-width":"200"}})],1)],1),t._v(" "),a("el-form-item",{staticClass:"brand",attrs:{label:"品牌选择"}},[a("table",t._l(t.brands,function(e,n){return a("tr",[a("td",[a("em",[t._v(t._s(n))]),t._v(" "),a("el-checkbox-group",{model:{value:t.brand_checkList,callback:function(e){t.brand_checkList=e},expression:"brand_checkList"}},t._l(e,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name)+"/"+t._s(e.cg_name)+"\n                ")])}))],1)])}))]),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("确认提交")])],1)],1)],1):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"编辑属性值",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"dynamicValidateForm",staticClass:"demo-dynamic",attrs:{model:t.dynamicValidateForm}},[t._l(t.dynamicValidateForm.domains,function(e,n){return a("el-form-item",{key:e.key,attrs:{prop:"domains."+n+".name",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[a("el-input",{attrs:{disabled:!!e.id,placeholder:"请填写属性值"},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"domain.name"}}),t._v(" "),a("el-button",{on:{click:function(a){a.preventDefault(),t.removeDomain(e)}}},[t._v("删除")])],1)}),t._v(" "),a("el-form-item",[a("el-button",{on:{click:t.addDomain}},[t._v("新增属性值")])],1)],2),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.generate_attr_value}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"添加规格",visible:t.spec_dialogVisible},on:{"update:visible":function(e){t.spec_dialogVisible=e}}},[a("div",{staticClass:"spec-box"},[a("p",[a("span",[t._v("规格选择")]),a("span",[t._v("规格预览")])]),t._v(" "),a("div",{staticClass:"spec-box-left"},[a("el-radio-group",{on:{change:t.spec_choice},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},t._l(t.specs,function(e){return a("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name)),e.note?a("span",[t._v("("+t._s(e.note)+")")]):t._e()])}))],1),t._v(" "),a("div",{staticClass:"spec-box-right"},t._l(t.spec_value,function(e){return a("span",[t._v(t._s(e.name))])}))]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.spec_dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.generate_add_spec}},[t._v("确 定")])],1)])],1)},r=[],d={render:c,staticRenderFns:r},p=d,u=a("VU/8"),f=n,h=u(l,p,!1,f,"data-v-44fac9bf",null);e.default=h.exports},pw1D:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"\n.attr-table[data-v-44fac9bf] {\n  width: 100%;\n}\n.attr-table[data-v-44fac9bf] {\n  border: 1px solid #dfe6ec;\n}\n.attr-table th[data-v-44fac9bf] {\n  border-bottom: 1px solid #dfe6ec;\n  height: 40px;\n  white-space: nowrap;\n  overflow: hidden;\n  background-color: #eef1f6;\n  padding: 0 18px;\n}\n.attr-table td[data-v-44fac9bf] {\n  padding: 10px 18px;\n}\n.attr-table .el-button[data-v-44fac9bf] {\n  width: 100px;\n  height: 36px;\n  margin: 0;\n}\n.prop .el-table .el-button[data-v-44fac9bf] {\n  width: 100px;\n  height: 32px;\n  margin: 0;\n}\n.el-dialog .el-input[data-v-44fac9bf] {\n  width: 80%;\n}\n.btn-th[data-v-44fac9bf] {\n  width: 245px;\n}\n.ipt-th[data-v-44fac9bf] {\n  width: 160px;\n}\n.spec-box[data-v-44fac9bf] {\n  overflow: hidden;\n  border: 1px solid #eee;\n  padding: 10px;\n}\n.spec-box > p[data-v-44fac9bf] {\n  border-bottom: 1px solid #f3f3f3;\n  padding-bottom: 10px;\n}\n.spec-box > p span[data-v-44fac9bf] {\n  display: inline-block;\n  width: 160px;\n  line-height: 20px;\n}\n.spec-box-left[data-v-44fac9bf] {\n  width: 160px;\n  border-right: 1px solid #eee;\n  float: left;\n}\n.spec-box-left .el-radio[data-v-44fac9bf] {\n  padding-left: 15px;\n  line-height: 32px;\n  margin: 0;\n}\n.spec-box-right[data-v-44fac9bf] {\n  margin-left: 160px;\n  padding: 15px;\n}\n.spec-box-right span[data-v-44fac9bf] {\n  padding: 5px 10px;\n  background-color: #ff4949;\n  color: #fff;\n  border-radius: 5px;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  display: inline-block;\n  margin-bottom: 10px;\n  margin-right: 10px;\n}\n.brand[data-v-44fac9bf] {\n  height: 460px;\n  overflow-y: scroll;\n}\n",""])}});